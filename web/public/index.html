<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Weirauch Lab - After the Infection: A Survey of Pathogens and Non-communicable Human Disease</title>
  <link rel="stylesheet"
        href="https://cdn.datatables.net/v/dt/jq-3.7.0/dt-2.1.8/b-3.2.0/b-html5-3.2.0/fh-4.0.1/datatables.min.css">
  <link rel="stylesheet" href="css/style.css" media="all">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="application-name"
        content="After the Infection: A Survey of Pathogens and Non-communicable Human Disease">
  <meta name="description"
        content="After the Infection: A Survey of Pathogens and Non-communicable Human Disease">
  <meta name="generator" content="Vim">
  <meta name="generator" content="GNU m4">
  <meta name="author" content="Michael Lape">
  <meta name="author" content="Daniel Schnell">
  <meta name="author" content="Sreeja Parameswaran">
  <meta name="author" content="Kevin Ernst">
  <meta name="author" content="Shannon O'Connor">
  <meta name="author" content="Nathan Salomonis">
  <meta name="author" content="Lisa J. Martin">
  <meta name="author" content="Brett M. Harnett">
  <meta name="author" content="Leah C. Kottyan">
  <meta name="author" content="Matthew T. Weirauch">
  <meta name="creator" content="Michael Lape">
  <meta name="creator" content="Kevin Ernst">
  <meta name="creator" content="Weirauch Transcription Factor Research Laboratory">
  <meta name="creator" content="Center for Autoimmune Genomics and Etiology">
  <meta name="creator" content="Cincinnati Children's Hospital Medical Center">
  <meta name="keywords" content="bioinformatics,genomics,research,paper,publication,survey,human,virus,gene regulation,transcription factor,disease,weirauch lab,cincinnati children's hospital">

</head>
<body>
  <div id="top" class="top">
    <div id="logos">
      <a href="https://weirauchlab.org" title="Visit the Weirauch Lab home page">
        <img width="158" height="52" src="img/cchmc.png" alt="Children's Hospital logo">
      </a>
    </div>

    <div id="header">
      <h1 id="headline">After the Infection: A Survey of Pathogens<br>
        and Non-communicable Human Disease</h1>
      <!--h3 id="tagline"></h3-->
      <p id="authors">
        <span>
          Michael Lape<sup><a href="#fn-1">1</a>, <a href="#fn-2">2</a>, <a href="#fn-3">3</a></sup></span>, 
        <span>
          Daniel Schnell<sup><a href="#fn-2">2</a></sup></span>, 
        <span>
          Sreeja Parameswaran<sup><a href="#fn-3">3</a>, <a href="#fn-6">6</a></sup></span>, 
        <span>
          Kevin Ernst<sup><a href="#fn-3">3</a></sup></span>, 
        <span>
          Shannon O'Connor<sup><a href="#fn-7">7</a></sup></span>, 
        <span>
          Nathan Salomonis<sup><a href="#fn-1">1</a>, <a href="#fn-2">2</a>, <a href="#fn-4">4</a></sup></span>, 
        <span>
          Lisa J. Martin<sup><a href="#fn-4">4</a>, <a href="#fn-6">6</a></sup></span>, 
        <span>
          Brett M. Harnett<sup><a href="#fn-1">1</a></sup></span>, 
        <span>
          Leah C. Kottyan<sup><a href="#fn-3">3</a>, <a href="#fn-4">4</a>, <a href="#fn-6">6</a>, <a href="#fn-8">8</a>, <a href="#fn-star">*</a></sup></span>, 
        <span>
          Matthew T. Weirauch<sup><a href="#fn-2">2</a>, <a href="#fn-3">3</a>, <a href="#fn-4">4</a>, <a href="#fn-5">5</a>, <a href="#fn-6">6</a>, <a href="#fn-8">8</a>, <a href="#fn-star">*</a></sup></span>
      </p>

      <p id="affiliations">
        <a class="footnote" id="fn-1"><sup>1</sup><span>Department of Biomedical Informatics, University of Cincinnati College of Medicine, Cincinnati, Ohio, USA</span></a>;
        <a class="footnote" id="fn-2"><sup>2</sup><span>Division of Biomedical Informatics, Cincinnati Children’s Hospital Medical Center, Cincinnati, Ohio, USA</span></a>;
        <a class="footnote" id="fn-3"><sup>3</sup><span>Center for Autoimmune Genomics and Etiology, Cincinnati Children’s Hospital Medical Center, Cincinnati, Ohio, USA</span></a>;
        <a class="footnote" id="fn-4"><sup>4</sup><span>Department of Pediatrics, University of Cincinnati College of Medicine, Cincinnati, Ohio, USA</span></a>;
        <a class="footnote" id="fn-5"><sup>5</sup><span>Division of Developmental Biology, Cincinnati Children’s Hospital Medical Center, Cincinnati, OH, USA</span></a>;
        <a class="footnote" id="fn-6"><sup>6</sup><span>Division of Human Genetics, Cincinnati Children’s Hospital Medical Center, Cincinnati, OH, USA</span></a>;
        <a class="footnote" id="fn-7"><sup>7</sup><span>Division of Rheumatology, Cincinnati Children’s Hospital Medical Center, Cincinnati, OH, USA</span></a>;
        <a class="footnote" id="fn-8"><sup>8</sup><span>Division of Allergy & Immunology, Cincinnati Children’s Hospital Medical Center, Cincinnati, OH, USA</span></a>;
        
        <a class="footnote" id="fn-star"><sup>*</sup><span>Co-corresponding authors</span></a>:
        <a href="mailto:Leah.Kottyan@cchmc.org?subject=Pathogenic%20Organism%20NCD%20web%20site">Leah.Kottyan@cchmc.org</a>;
        <a href="mailto:Matthew.Weirauch@cchmc.org?subject=Pathogenic%20Organism%20NCD%20web%20site">Matthew.Weirauch@cchmc.org</a><br>
      </p>


      <div class="actions actions-top">
        <!-- the 'onclick' is necessary to make the ENTIRE button clickable -->
        <button id="download-btn" onclick="location.href='data/pathogen_ncd-db-build-0.0.1.zip'"
                title="Download database build 0.0.1, released 1 September 2023 (1050 KB); .zip format, DOS/Windows CR+LF line endings">
          <a href="data/pathogen_ncd-db-build-0.0.1.zip">
            <strong>Download Datasets</strong>
            <small>v0.0.1, released 1 September 2023 (1050 KB)</small>
          </a>
        </button>

        <button type="button" title="Download supplemental data and tables from the publication (as a .zip archive)"
                onclick="location.href='data/pathogen_ncd-supplement.zip'">
          <a href="data/pathogen_ncd-supplement.zip">
            Download Supplemental Data
            <small>Supplemental figures and tables from the medRxiv (2023) paper</small>
          </a>
        </button>

        <button id="search-btn" onclick="location.href='#search'">
          <a href="#search">Search Datasets</a>
        </button>
        <div class="subtle-link" id="links-to-footer">
          <p>
            <a href="data/pathogen_ncd-db-build-0.0.1.tar.gz"
               title="Download suplemental data v0.0.1, released 1 September 2023 (1048 KB); tar.gz format, LF line endings"
            >Datasets as Unix tarball (LF line endings)</a>
            &nbsp;|&nbsp;
            <a href="data/MD5SUMS"
               title="MD5 checksums, for verifying download integrity"
            >Checksums</a>
            &nbsp;|&nbsp;
            <a href="data" title="View all available downloads">All downloads</a>
          </p>
        </div>
      </div><!--/.actions.actions-top-->
    </div><!--/#header-->


    <hr>

    <div id="abstract">
      <h2>Abstract</h2>
      <p>
        There are many well-established relationships between pathogens and
        human disease, but far fewer when focusing on non-communicable diseases
        (NCDs). We leverage data from The UK Biobank and TriNetX to perform a
        systematic survey across 20 pathogens and 426 diseases, primarily NCDs.
        To this end, we assess the association between disease status and
        infection history proxies. We identify 206 pathogen-disease pairs that
        replicate in both cohorts. We replicate many established relationships,
        including <em>Helicobacter pylori</em> with several gastroenterological
        diseases and connections between Epstein-Barr virus with multiple
        sclerosis and lupus. Overall, our approach identified evidence of
        association for 15 pathogens and 96 distinct diseases, including a
        currently controversial link between human cytomegalovirus (CMV) and
        ulcerative colitis (UC). We validate this connection through two
        orthogonal analyses, revealing increased CMV gene expression in UC
        patients and enrichment for UC genetic risk signal near human genes that
        have altered expression upon CMV infection. Collectively, these results
        form a foundation for future investigations into mechanistic roles
        played by pathogens in NCDs. All results are easily accessible right
        here.
      </p>

      <h2 id="how-to-cite">How to cite</h2>
      <p>
        Please cite this article as: Lape <em>et al.</em>, 
        "After the Infection: A Survey of Pathogens and Non-communicable Human Disease," medRxiv (2023),
        <a href="https://www.medrxiv.org/content/10.1101/2023.09.14.23295428">doi:10.1101/2023.09.14.23295428</a>
      </p>

      <h2 id="feedback">Feedback</h2>
      <p>
        Have feedback on how we can make this resource better?
        <a href="mailto:Matthew.Weirauch@cchmc.org?cc=Leah.Kottyan@cchmc.org&subject=Pathogenic%20Organisms%20and%20NCDs">
          Let us know</a>.
      </p>
      <br>

    </div><!--/#abstract-->

    <hr>

  </div><!--/#top-->

  <div id="search" class="top">
    <h1>
      Search datasets
      <button title="Back to the top" id="search-to-top-btn"
              onclick="location.href='#top'">
        <a href="#top">&uparrow;</a>
      </button>
    </h1>

    <div id="search-help-container">
      <div id="search-help" style="display:none">
        <p>Hover your mouse pointer over <strong>column names</strong> for a full
        description.

        <p>The search box performs "fuzzy" matching, and may match across
        multiple columns. To search for an exact phrase, put it in double quotes,
        <em>e.g.</em>, <code>"disorders of urinary system"</code>.

        <p>The <strong>Copy</strong> and <strong>Download CSV</strong> buttons
        will copy the <em>entire</em> table, including records not currently
        shown, to the system clipboard, or download it as a comma-separated
        values file. The former can be pasted directly into a spreadsheet
        program such as Excel, LibreOffice Calc, or Google Sheets with
        <span class="hotkey"><kbd>Ctrl</kbd>&thinsp;+&thinsp;<kbd>V</kbd></span>,
        or <kbd>⌘&thinsp;V</kbd> on a Mac. See
        <a class="ul-link" href="data">the <code>data</code>
        directory</a> directory for other formats.
        <!--p>
          Cell values with dotted underlines styling are clickable, and will
          open in the relevant web site <strong>in the current window/tab</strong>.
          Hold down the <kbd>Ctrl</kbd> key on the keyboard (or <kbd>⌘</kbd> on
          a Mac) as you click to open these links in a new tab.-->
      </div><!-- /.search-help -->

      <div id="search-help-toggle-cont" style="display:none">
        <p><a id="search-help-toggle" href="#">Search help</a></p>
      </div>
    </div><!-- /.search-help-container -->

    <div class="block">
      <noscript>
        <h2 class="center">Hello Non-JavaScript User</h2>
        <p>It seems you've disabled JavaScript in your browser, or blocked
        this site from executing it.
        <a href="https://www.gnu.org/philosophy/javascript-trap.html" title="The JavaScript Trap - gnu.org">That's prudent</a>!
        </p>

        <p>Because this is little more than a modest Apache
        <a href="https://httpd.apache.org/docs/2.4/mod/mod_autoindex.html"><tt>mod_autoindex</tt></a>
        theme on top of an otherwise unadorned web-accessible directory on our
        web server, you should still have no problem downloading the relevant datasets
        hosted here. These may be found in the <a href="data"><code>data</code>
        subdirectory</a></p>

        <p>If however, you wish to interactively search through and filter the
        data dynamically, that will require re-enabling JavaScript for this
        page. That's what you <em>would've</em> seen here, in this space, had
        you visited this site with JavaScript enabled.</p>

        <p>Stay classy!</p>
      </noscript>
    </div><!--/.block-->
  </div><!-- /#search -->

  <div id="tabs-and-tables" class="wrapper">

    <div class="tabs">
      <div class="tab"> 
        <input type="radio" id="tab-icd" name="table-tabs" checked>
        <label for="tab-icd" class="tablabel">ICD10</label>
      </div> <!-- /.tab -->

      <div class="tab"> 
        <input type="radio" id="tab-phe" name="table-tabs">
        <label for="tab-phe" class="tablabel">Phecode</label>
      </div> <!-- /.tab -->
    </div> <!-- /.tabs --> 
    <div class="tab-separator"></div>

    <div id="table-viewer">
      <!-- loadTab replaces what is here -->
      <div class="loading">
        <p>Fetching and formatting <span id="which-tab">ICD10</span> data…</p>
        <p class="small">Nothing showing up here?
          <a class="ul-link"
              href="mailto:tftoolsadmin@cchmc.org?subject=Pathogenic%20Organisms%20and%20NCDs%20is%20not%20loading%20the%20data%properly!"
          >Please let us know</a>.
        </p>
      </div>
      <div id="table-icd" style="display:none;"></div>
      <div id="table-phe" style="display:none;"></div>
    </div> <!-- /#table-viewer -->

  </div> <!-- /.wrapper -->

  <div class="block" id="footer-md" data-markdown>
    <!-- content comes from 'footer.md', loaded by XMLHttpRequest -->
  </div>

  <div class="actions actions-bottom">
    <button id="to-top-btn" onclick="location.href='#top'">
      <a href="#top">&uparrow; Back to Top &uparrow;</a>
    </button>
  </div>

  <div id="footer" class="footer">
    <p>
      Problems?
      <a id="admin-contact" class="ul-link"
         href="mailto:tftoolsadmin@cchmc.org?subject=Problem%20with%20Pathogenic%20Organisms%20and%20NCDs%20web%20site"
      >Please let the site admin know</a>.
    </p>
    <p>
      &copy;2025 
      <a href="https://www.cincinnatichildrens.org/research/divisions/a/genomics-etiology">The Center for Autoimmune Genomics and Etiology</a>
      &bull; <a href="https://weirauchlab.org">Weirauch Research Lab</a>
      &bull; <a href="https://cincinnatichildrens.org">Cincinnati Children's Hospital Medical Center</a>
    </p>
  </div><!--/.footer-->


  <script src="https://cdn.datatables.net/v/dt/jq-3.7.0/dt-2.1.8/b-3.2.0/b-html5-3.2.0/fh-4.0.1/datatables.min.js"></script>
  <script src="vendor/jscookie/js.cookie-2.2.1.min.js"></script>
  <script>
    // add DataTables assets to the <head>, only when JavaScript is enabled
    $(document).ready(function() {
      var stylesheets = [
      ];
      stylesheets.forEach(function(s) {
        $('head').append('<link rel="stylesheet" href="' + s + '">');
      });

// wire up tooltips for all of the affiliations
var affil;

$('#authors sup a')
  .click(function(e) {
    e.preventDefault();
  })
  .mouseover(function() {
    // get associated a.footnote > span
    affil = $($(this).attr('href'));
    affil.addClass('highlight');
  })
  .mouseout(function() {
    affil = $($(this).attr('href'));
    affil.removeClass('highlight');
  });


// wire up the "Hide this help" link
var toggleHelpContainer = $('#search-help-toggle-cont');
var toggleHelpLink = $('#search-help-toggle');
var searchHelp = $('#search-help');
var showHelpText = 'Show search help';
var hideHelpText = 'Hide this help';

// if user hasn't hidden the search help on their last visit
if (Cookies.get('search-help-hidden')) {
  toggleHelpLink.text(showHelpText);
} else {
  toggleHelpLink.text(hideHelpText);
  searchHelp.show();
}

// now that the link text is updated, show the show/hide link
toggleHelpContainer.show();

toggleHelpLink.on('click', function(e) {
  e.preventDefault();
  searchHelp.animate({
    opacity: 'toggle',
    height: 'toggle'
  }, function() {
    if (searchHelp.is(':hidden')) {
      toggleHelpLink.text(showHelpText);
      // https://github.com/js-cookie/js-cookie#basic-usage
      Cookies.set('search-help-hidden', 'y', { expires: 400, path: '' });
    } else {
      toggleHelpLink.text(hideHelpText);
      Cookies.remove('search-help-hidden', { path: '' });
    }
  });
});


// wire up the "ICD10" and "Phecode" tabs
// the string arguments to 'loadTab' correspond to the names of the
// columns.json keys and data/pathogen_ncd-{ICD,PHE}.tsv files
$('#tab-icd').on('click', e => loadTab('ICD'));
$('#tab-phe').on('click', e => loadTab('PHE'));

// load the default tab, but don't scroll to it
loadTab('ICD', false);

// formatter for the child rows (expanded details)
function formatChild(rowdata) {
  var div = '<div class="childrow"><ul>';

  columnDefs.forEach(function(cdef) {
    if (cdef.visible !== false) return;  // skip the visible ones

    var colidx = cdef.targets;           // the column index
    if (colidx < 2) return;              // skip details and rowid
    var title = columnDefs[colidx].title || columnDefs[colidx].name;
    var desc = columnDefs[colidx].description;

    // set a default for empty rows
    var value = rowdata[colidx] || '<span class="muted">empty</span>';

    // split comma-delimited values so they wrap properly
    value = value.replace(/,(\w)/g, ', $1');

    // make everything that looks like a PMID into a link; chop off the ".0"
    // that's proabably 'in2csv' trying to do type inference, but failed
    value = value.replace(
      /(\d{6,})(\.0)?/g,
      '<a title="Open PubMed record for PMID $1 (in current window/tab)" ' +
      'href="https://www.ncbi.nlm.nih.gov/pubmed/?term=$1">$1</a>'
    );

    // make everything that looks like a UniProt name into a link
    value = value.replace(
      /([A-Z][A-Z0-9_]{5,})/g,
      '<a title="Open UniProtKB record for \'$1\' (in current window/tab)" ' +
      'href="https://www.uniprot.org/uniprot/$1">$1</a>'
    );

    // add <abbr> tags for Direct/Inferred/No evidence
    value = value.replace(
      /\b(D)(?=\()/g, '<abbr title="Direct evidence">$1</abbr>'
    ).replace(
      /\b(I)(?=\()/g,
      '<abbr title="Inferred evidence; e.g., experiment assayed ' +
      'orthologous protein">$1</abbr>'
    ).replace(
      /^(N)$/g, '<abbr title="No available evidence">$1</abbr>'
    );

    // add a label (with a tooltip) to each value
    div += '<li><span class="childrow-title" title="' + desc + '">' +
           title + '</span>: ' + value + '</li>';
  });

  div += '</ul></div>';
  return div;
} // formatChild


function doDetailsControlOnClick() {
  // Add event listener for opening and closing details (not currently used)
  // source: https://datatables.net/examples/api/row_details.html
  $('#datatable tbody')
    .on('click', 'td.details-control', function() {
      var tr = $(this).closest('tr');  // the parent <tr>
      var row = dt.row(tr);            // the entire (DataTables) row object

      if (row.child.isShown()) {
        row.child.hide();
        tr.removeClass('shown');
      } else {
        row.child(formatChild(row.data())).show();
        tr.addClass('shown');
      }
    });
} // doDetailsControlOnClick


function scrollTabsToTop() {
  // also works, but not sure how to animate it
  //$('#tabs-and-tables')[0].scrollIntoView();
  var tabsTop = $('#tabs-and-tables').offset().top;
  $('html, body').animate({ scrollTop: tabsTop }, 500);
}


function loadTab(which, scrollTo = true) {
  var tsv = "data/pathogen_ncd-" + which + '.tsv';
  var tableDiv = $('#table-' + which.toLowerCase());
  var columnDefs = {
  "ICD": [
    {
      "targets": 0,
      "name": "Disease",
      "title": "Disease",
      "description": "Disease name",
      "width": "26%"
    },
    {
      "targets": 1,
      "name": "ICD10",
      "title": "ICD10",
      "description": "ICD10 3-character code from UKB",
      "width": "8%"
    },
    {
      "targets": 2,
      "name": "Pathogen",
      "title": "Pathogen",
      "description": "Pathogenic organism abbreviation",
      "width": "10%"
    },
    {
      "targets": 3,
      "name": "Pair_is_Assoc",
      "title": "Pair is assoc?",
      "description": "Boolean indicating whether this pair is considered replicated",
      "width": "12%"
    },
    {
      "targets": 4,
      "name": "Std_Lev",
      "title": "Std. lev.",
      "description": "Standard group this pair is part of [Unknown (unk), Tier 1, Tier 2, Expected Negative (exp_neg)]",
      "width": "8%"
    },
    {
      "targets": 5,
      "name": "UKB_FDR",
      "title": "UKB FDR",
      "description": "Per-disease BH FDR adjusted UKB nominal p-value",
      "width": "8%",
      "type": "num"
    },
    {
      "targets": 6,
      "name": "TNX_FDR",
      "title": "TNX FDR",
      "description": "Per-disease BH FDR adjusted TNX nominal p-value",
      "width": "8%",
      "type": "num"
    },
    {
      "targets": 7,
      "name": "UKB_OR",
      "title": "UKB OR",
      "description": "Odds ratio for UKB titer [continuous]",
      "width": "8%",
      "type": "num"
    },
    {
      "targets": 8,
      "name": "TNX_OR",
      "title": "TNX OR",
      "description": "Odds ratio for TNX association test [categorical]",
      "width": "8%",
      "type": "num"
    }
  ],

  "PHE": [
    {
      "targets": 0,
      "name": "Disease_Description",
      "title": "Disease",
      "description": "Disease name",
      "width": "26%"
    },
    {
      "targets": 1,
      "name": "Phecode",
      "title": "Phecode",
      "description": "Code representing Phenome-Wide Association Studies (PheWAS); see doi:10.1038/nbt.2749 and https://phewascatalog.org",
      "width": "8%",
      "type": "string"
    },
    {
      "targets": 2,
      "name": "Pathogen",
      "title": "Pathogen",
      "description": "Pathogenic organism abbreviation",
      "width": "10%"
    },
    {
      "targets": 3,
      "name": "Pair_is_Assoc",
      "title": "Pair is assoc?",
      "description": "Boolean indicating whether this pair is considered replicated",
      "width": "12%"
    },
    {
      "targets": 4,
      "name": "Std_Lev",
      "title": "Std. lev.",
      "description": "Standard group this pair is part of [Unknown (unk), Tier 1, Tier 2, Expected Negative (exp_neg)]",
      "width": "8%"
    },
    {
      "targets": 5,
      "name": "UKB_FDR",
      "title": "UKB FDR",
      "description": "Per-disease BH FDR adjusted UKB nominal p-value",
      "width": "8%",
      "type": "num"
    },
    {
      "targets": 6,
      "name": "TNX_FDR",
      "title": "TNX FDR",
      "description": "Per-disease BH FDR adjusted TNX nominal p-value",
      "width": "8%",
      "type": "num"
    },
    {
      "targets": 7,
      "name": "UKB_OR",
      "title": "UKB OR",
      "description": "Odds ratio for UKB titer [continuous]",
      "width": "8%",
      "type": "num"
    },
    {
      "targets": 8,
      "name": "TNX_OR",
      "title": "TNX OR",
      "description": "Odds ratio for TNX association test [categorical]",
      "width": "8%",
      "type": "num"
    }
  ]    
}
;
  var columnDefs = columnDefs[which];
  var loadingMsg = $('#table-viewer .loading');

  $('#table-viewer').children().hide();

  // don't re-download if already loaded
  if (tableDiv.hasClass('loaded')) {
    tableDiv.show();
    scrollTabsToTop();
    return;
  }

  $('#which-tab').text(which == 'PHE' ? 'Phecode' : 'ICD10');
  loadingMsg.show();

  // start: fetch the table data with XHR
  var jqxhr = $.ajax({ url: tsv })
    .done(function(data, status, xhr) {
      console.info("Fetched '" + tsv + "'; HTTP status " + xhr.status);
      var table = $('<table>');
      var tableID = 'datatable-' + which.toLowerCase();
      table.attr('id', tableID);
      table.addClass('display verycompact');  // & possibly 'nowrap'

      tableDiv.fadeOut();
      loadingMsg.hide()
      tableDiv.append(table);
      tableDiv.addClass('loaded');
      tableDiv.fadeIn();

      // break up the .tsv file into an array, discarding the header row, and
      // the final, empty element (since Unix text files are newline-delimited)
      var data = data.split(/\n/).slice(1).filter(e => e.length);
      // now, split on tab characters to make a two-dimensional array
      data = data.map(e => e.split(/\t/));

      var dt = table.DataTable({
        data: data,
        order: [
          { name: 'Pair_is_Assoc', dir: 'desc' },
          { name: 'UKB_FDR', dir: 'asc' },
        ],
        layout: {
          //topStart: [ 'pageLength', { buttons: ['colvis'] } ],
          topEnd: [
            { buttons: [
                { extend: 'copy', text: 'Copy' },
                { extend: 'csv', text: 'Download CSV' }
              ]
            },
            'search',
          ],
        },
        scrollX: false,
        lengthMenu: [[10, 25, 100, -1], [10, 25, 100, "All"]],
        pageLength: 100,
        columnDefs: columnDefs,
        // disabled for now; doesn't work with the tabs
        //fixedHeader: true,
        // https://datatables.net/reference/option/deferRender
        deferRender: true,
        // https://datatables.net/examples/advanced_init/row_callback.html
        createdRow: (r, d, i) => {
          // replace empty cells in both TNX columns with 'n/a'
          if (d[6] == "") r.querySelector(':nth-child(7)').textContent = 'n/a';
          if (d[8] == "") r.querySelector(':nth-child(9)').textContent = 'n/a';
        },
      }); // DataTable init

      // onclick handler for opening and closing details (not currently used)
      //doDetailsControlOnClick();

      // tooltips for DataTables Buttons extension (until I find a better way)
      $('button.dt-button.buttons-copy').attr(
          'title', "Copy table data to the system clipboard "
                 + "(all pages, ignoring search/filters)");
      $('button.dt-button.buttons-csv').attr(
          'title', "Download table data as a comma-separated value (.csv) file");

      // add tooltips for column headers; arrow functions don't have a 'this'!
      // ref: https://old.reddit.com/r/javascript/comments/nqrmuu/askjs_why_are_arrow_functions_used_so_universally/h0ct1xb
      table.find('thead th').each(function(i) {
        $(this).attr('title', columnDefs[i].description);
      });

      // wire up the "Search" button to focus the search box
      var searchBox = $('#' + tableID + '_wrapper input[type="search"]');
      var searchButton = $('#search-btn');
      var searchHeader = $('#search');

      // FIXME: animate or highlight somehow
      searchButton.click(function(e) {
        e.preventDefault();
        // just like the anchor would've done
        searchHeader[0].scrollIntoView();
        searchBox.focus();
      });

      // initially hide the pagination controls
      var pageLengthSelect = $('select[name="datatable_length"]');
      var paginateControls = $('#' + tableID + '_paginate');
      if (pageLengthSelect.val() === '-1') paginateControls.hide();

      // and if the select box is set to "All"
      pageLengthSelect.change(function(e) {
        if ($(this).val() === '-1') {
          paginateControls.hide();
        } else {
          paginateControls.show();
        }
      });

      // finally, scroll so the tab strip is at the top of the viewport
      if (scrollTo) scrollTabsToTop();
    }) // done

    .fail(function(data, status, xhr) {
      console.error("Error loading '" + tsv + "'; HTTP status " +
                    xhr.status + " (" + status + ")");
      alert("Unable to load the data table. Perhaps contact " +
            "the administrator using the link at the bottom of the page?");
    });
} // loadTab(which)

    });
  </script>
</body>
</html>
<!--
vim: ts=2 sw=2 tw=80 expandtab
-->
